<!-- Is it okay to have 2 bodies? -->
<body class="text-center">
    <form class="form-signin" action="/register" method="POST">
        <img class="mb-4" src="../assets/CloudClub.png" alt="" width=80% height="80%">
        <h1 class="h3 mb-3 font-weight-normal">Please register</h1>
        <label for="inputFirstName" class="sr-only">First Name</label>
        <input type="text" name="firstName" id="inputFirstName" class="form-control" placeholder="First Name" required autofocus>
        <label for="inputLastName" class="sr-only">Last Name</label>
        <input type="text" name="lastName" id="inputLastName" class="form-control" placeholder="Last Name" required>
        <label for="inputEmail" class="sr-only">Email address</label>
        <input type="email" name="email" id="inputEmail" class="form-control" placeholder="Email Address" required>
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" name="password" id="inputPassword" class="form-control" placeholder="Password" required>
        <!-- Manually override button colour for now -->
        <button class="btn btn-lg btn-primary btn-block" style="background-color: #50BDE4" type="submit">Sign in</button>
        <p class="mt-5 mb-3 text-muted">Â© 2017-2020</p>
    </form>
</body>

<div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay=2000 style="position:absolute;">
  <div class="toast-header">
    <strong class="mr-auto">Error!</strong>
    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="toast-body"></div>
</div>

<script type="text/javascript">
  $('.form-signin').submit(function(event) {
    event.preventDefault();
    $.ajax({
      url: '/register',
      type: 'POST',
      cache: false,
      dataType: 'json',
      data: {
        firstName: $('#inputFirstName').val(),
        lastName: $('#inputLastName').val(),
        email: $('#inputEmail').val(),
        password: $('#inputPassword').val()
      },
      statusCode: {
        201: function(response) {
          $.ajax({
              url: '/login',
              type: 'POST',
              cache: false,
              dataType: 'json',
              data: {
                email: $('#inputEmail').val(),
                password: $('#inputPassword').val()
              },
              statusCode: {
                200: function() {
                  window.location.href = "/";
                },
                401: function(response) {
                  alert(response.responseJSON.Message);
                }
              }
            });
        },
        401: function(response) {
          $('.toast-body').text(response.responseJSON.Message);
          $('.toast').toast('show');
        },
        409: function(response) {
          $('.toast-body').text(response.responseJSON.Message);
          $('.toast').toast('show');
        }
      }
    })
  });
</script>